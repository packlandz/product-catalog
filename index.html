<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Product Catalog</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #fff;
      margin: 0;
      padding: 0;
    }

    header {
      text-align: center;
      padding: 20px;
      background: #1f1f1f;
    }

    .tabs {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 10px;
    }

    .tabs button {
      padding: 10px 15px;
      border: none;
      background: #2a2a2a;
      color: #fff;
      border-radius: 10px;
      cursor: pointer;
    }

    .tabs button.active {
      background: #4caf50;
    }

    .main-content {
      display: flex;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      padding: 20px 10px 20px 60px;
      flex: 1;
    }

.card {
  background: #1e1e1e;
  border-radius: 12px;
  padding: 12px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
}

.card img {
  width: 100%;
  height: 120px;
  object-fit: cover;
  border-radius: 8px;
  margin-bottom: 10px;
}

.card h3 {
  margin: 0;
  font-size: 16px;
  text-align: center;
  margin-bottom: 6px;
}

.card .description {
  font-size: 13px;
  color: #ccc;
  text-align: center;
  margin-bottom: 6px;
}

.card p {
  margin: 4px 0;
  font-size: 14px;
  text-align: center;
}


    .pagination {
      text-align: center;
      padding: 15px;
    }

    .pagination button {
      margin: 0 5px;
      padding: 5px 10px;
      background: #333;
      border: none;
      color: white;
      border-radius: 6px;
    }

    #adminForm {
      display: none;
      background: #1c1c1c;
      padding: 20px;
      margin: 20px;
      border-radius: 12px;
    }

    #adminForm input, #adminForm select, #adminForm button, #adminForm textarea {
      display: block;
      margin: 10px 0;
      padding: 10px;
      width: 100%;
      border: none;
      border-radius: 8px;
      font-family: Arial, sans-serif;
    }

    #productDescription {
      resize: vertical;
      height: 60px;
    }

    .sidebar {
      width: 220px;
      padding: 20px;
      background-color: #1f1f1f;
      border-left: 2px solid #2a2a2a;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .sidebar a {
      display: inline-block;
      background: #0088cc;
      color: white;
      padding: 10px 15px;
      border-radius: 20px;
      text-decoration: none;
      text-align: center;
      width: 100%;
    }

    #searchInput {
      padding: 8px 12px;
      border-radius: 12px;
      border: none;
      font-size: 14px;
      outline: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Product Catalog</h1>
    <div class="tabs" id="categoryTabs">
      <button data-category="All" class="active">All</button>
      <button data-category="Best sellers">Best sellers</button>
      <button data-category="Flower">Flower</button>
      <button data-category="Concentrates">Concentrates</button>
      <button data-category="Carts">Carts</button>
      <button data-category="Disposables">Disposables</button>
      <button data-category="Edibles">Edibles</button>
      <button data-category="Miscellaneous">Miscellaneous</button>
    </div>
  </header>

  <div class="main-content">
    <div id="productGrid" class="grid"></div>
    <div class="sidebar">
      <input type="text" id="searchInput" placeholder="Search products..." />
      <a href="https://t.me/your_telegram" target="_blank">Join Telegram</a>
    </div>
  </div>

  <div class="pagination" id="paginationControls"></div>

  <form id="adminForm">
    <h3>Add / Edit Product</h3>
    <input type="text" id="productName" placeholder="Product Name" required />
    <textarea id="productDescription" placeholder="Description"></textarea>
    <input type="text" id="productPrice" placeholder="Price" required />
    <select id="productCategory">
      <option value="Best sellers">Best sellers</option>
      <option value="Flower">Flower</option>
      <option value="Concentrates">Concentrates</option>
      <option value="Carts">Carts</option>
      <option value="Disposables">Disposables</option>
      <option value="Edibles">Edibles</option>
      <option value="Miscellaneous">Miscellaneous</option>
    </select>
    <input type="text" id="productImage" placeholder="Image URL (optional)" />
    <button type="submit">Save Product</button>
  </form>

  <script>
    const adminForm = document.getElementById('adminForm');

    // Ctrl + . keyboard shortcut toggles form visibility
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === '.') {
        e.preventDefault();
        if (adminForm.style.display === 'none' || adminForm.style.display === '') {
          adminForm.style.display = 'block';
        } else {
          adminForm.style.display = 'none';
        }
      }
    });
  </script>
</body>
</html>

  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    getDocs,
    doc,
    updateDoc,
    deleteDoc,
    query,
    orderBy
  } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";
  import {
    getStorage,
    ref,
    uploadBytes,
    getDownloadURL
  } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBg--ptpq9wlQNH1HK-SRe88aDx1_yO7yQ",
    authDomain: "project-3390921463634312663.firebaseapp.com",
    projectId: "project-3390921463634312663",
    storageBucket: "project-3390921463634312663.firebasestorage.app",
    messagingSenderId: "451857573630",
    appId: "1:451857573630:web:94f4ee25f65ef4967ae7af"
  };

 const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const storage = getStorage(app);
  const productsRef = collection(db, "products");

  const adminForm = document.getElementById("adminForm");
  const productGrid = document.getElementById("productGrid");
  let editingProductId = null;

  async function loadProducts() {
    productGrid.innerHTML = "";
    const q = query(productsRef, orderBy("name"));
    const querySnapshot = await getDocs(q);
    querySnapshot.forEach((docSnap) => {
      const product = docSnap.data();
      const card = document.createElement("div");
      card.className = "product-card";
      card.innerHTML = `
        <img src="${product.image || ''}" alt="${product.name}">
        <h3>${product.name}</h3>
        <p>${product.description}</p>
        <p>$${product.price}</p>
        <button onclick="editProduct('${docSnap.id}', '${product.name}', '${product.description}', '${product.price}', '${product.category}', '${product.image}')">Edit</button>
        <button onclick="deleteProduct('${docSnap.id}')">Delete</button>
      `;
      productGrid.appendChild(card);
    });
  }

  window.editProduct = (id, name, description, price, category, image) => {
    editingProductId = id;
    document.getElementById("productName").value = name;
    document.getElementById("productDescription").value = description;
    document.getElementById("productPrice").value = price;
    document.getElementById("productCategory").value = category;
    adminForm.style.display = "block";
  };

  window.deleteProduct = async (id) => {
    if (confirm("Are you sure you want to delete this product?")) {
      await deleteDoc(doc(db, "products", id));
      loadProducts();
    }
  };

  adminForm.onsubmit = async (e) => {
    e.preventDefault();

    const name = document.getElementById("productName").value.trim();
    const description = document.getElementById("productDescription").value.trim();
    const price = document.getElementById("productPrice").value.trim();
    const category = document.getElementById("productCategory").value;
    const fileInput = document.getElementById("productImageFile");
    const file = fileInput.files[0];

    let imageUrl = "";

    try {
      if (file) {
        const storageRef = ref(storage, `productImages/${Date.now()}_${file.name}`);
        await uploadBytes(storageRef, file);
        imageUrl = await getDownloadURL(storageRef);
      }

      const productData = {
        name,
        description,
        price,
        category,
        image: imageUrl
      };

      if (editingProductId) {
        await updateDoc(doc(db, "products", editingProductId), productData);
      } else {
        await addDoc(productsRef, productData);
      }

      editingProductId = null;
      adminForm.reset();
      adminForm.style.display = "none";
      loadProducts();
    } catch (error) {
      alert("Failed to save product: " + error.message);
    }
  };

  loadProducts();
</script>
